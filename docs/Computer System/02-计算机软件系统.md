# 一、操作系统功能

![什么是操作系统，操作系统概述- 清风_Z - 博客园](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/1-1Z305103J0640.gif)

**操作系统（Operating System，OS）**是软件的一部分，它是硬件基础上的第一层软件，是硬件和其它软件沟通的桥梁（或者说接口、中间人、中介等）。

操作系统会控制其他程序运行，管理系统资源，提供最基本的计算功能，如管理及配置内存、决定系统资源供需的优先次序等，同时还提供一些基本的服务程序，例如：

1. 文件系统

   提供计算机存储信息的结构，信息存储在文件中，文件主要存储在计算机的内部硬盘里，在目录的分层结构中组织文件。文件系统为操作系统提供了组织管理数据的方式。

2. 设备驱动程序

   提供连接计算机的每个硬件设备的接口，设备驱动器使程序能够写入设备，而不需要了解执行每个硬件的细节。简单来说，就是让你能吃到鸡蛋，但不用养一只鸡。

3. 用户接口

   操作系统需要为用户提供一种运行程序和访问文件系统的方法。如常用的 Windows 图形界面，可以理解为一种用户与操作系统交互的方式；智能手机的 Android 或 iOS 系统，也是一种操作系统的交互方式。

4. 系统服务程序

   当计算机启动时，会自启动许多系统服务程序，执行安装文件系统、启动网络服务、运行预定任务等操作。

OS分类： 

- 服务器OS：CentOS，Ubuntu，Windows Server，AIX
- 桌面OS：Windows 10，Mac OS，Fedora
- 移动设备OS：Andriod，IOS，AliOS，HarmonyOS

# 二、操作系统相关概念

## 2.1 接口

interface，来源于电气工程学科，指的是插座与插头的连接口，起到将电与电器连接起来的功能。后来延伸到软件工程里指软件包向外提供的功能模块的函数接口。所以接口是用来连接两个东西、信号转换和屏蔽细节。

操作系统通过接口的方式，建立了用户与计算机硬件的沟通方式。用户通过调用操作系统的接口来使用计算机的各种计算服务。

操作系统一般会提供两个重要的接口，来满足用户的一些一般性的使用需求：

- 命令行：实际是一个叫shell的终端程序提供的功能，该程序底层的实质还是调用一些操作系统提供的函数。
- 窗口界面：通过图形窗口程序接收来自操作系统的消息，比如:鼠标、键盘动作，进而做出一些响应。

**ABI**

Application Binary Interface，应用程序二进制接口，ABI描述了应用程序与OS之间的底层接口，允许编译好的目标代码在使用兼容ABI的系统中无需改动就能运行。

**API**

Application Programming Interface，应用程序开发接口，API定义了源代码和库之间的接口，因此同样的源代码可以在支持这个API的任何系统中编译。

## 2.2 用户态和内核态

![image-20240701212404316](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/image-20240701212404316.png)

计算机硬件资源都是操作系统内核进行管理的，目前操作系统都是基于多任务、多用户的。如果每个用户进程都可以随便访问操作系统内核的模块，改变状态，那整个操作系统的稳定性、安全性都大大降低。

为了将内核程序与用户程序隔离开，在硬件层面上提供了一次机制，将程序执行的状态分为了不同的级别，从0到3，数字越小，访问级别越高。

- 0 代表内核态，在该特权级别下，所有内存上的数据都是可见的，可访问的。
- 3 代表用户态，在这个特权级下，程序只能访问一部分的内存区域，只能执行一些限定的指令。

## 2.3 系统调用和函数库

![img](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/378920-20171105215548951-327708573.png)

对于非一般性使用需求，操作系统提供了一系列的函数调用给软件开发者，由软件开发者来实现一些用户需要的功能。

这些函数调用由于是操作系统内核提供的，为了有别于一般的函数调用，被称为系统调用。比如使用C语言进行软件开发时，经常用的printf函数，它的内部实际就是通过write这个系统调用，让操作系统内核把字符打印在屏幕上的。

## 2.4 用户空间和内核空间

![1719905058133](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/1719905058133.jpg)

操作系统的核心是内核(kernel)，它独立于普通的应用程序，可以访问受保护的内存空间，也有访问底层硬件设备的所有权限。为了保证内核的安全，现在的操作系统一般都强制用户进程不能直接操作内核。具体的实现方式基本都是由操作系统将虚拟地址空间划分为两部分，一部分为内核空间，另一部分为用户空间。

**用户空间：**

用户程序的运行空间。为了系统安全，它们是隔离的，即使用户的程序崩溃，内核也不受影响。

只能执行简单的运算，不能直接调用系统资源，必须通过系统接口（system call），才能向内核发出指令。

**内核空间：**

是 Linux 内核的运行空间，可以执行任意命令，调用系统的一切资源。

# 三、操作系统分类

## 3.1 操作系统演变 

1950年代，单用户系统：一次只能支持一个用户程序的运行。向用户提供联机交互式的工作环境，如：DOS

- 批处理系统：用户将一批作业提交给操作系统后就不再交互，由操作系统控制自动运行，提高系统运行效率
- 多道程序系统：指允许多个程序同时进入内存并运行。即同时把多个程序放入内存，并允许它们交替在CPU中运行，它们共享系统中的各种硬、软件资源。当一道程序因I/O请求而暂停运行时，CPU便立即转去运行另一道程序。

1960年代，分时系统：提高系统利用率，操作系统控制 CPU 处理顺序，一台计算机可同时连接多个用户终端，而每个用户可在自己的终端上联机使用计算机，好象自己独占机器一样。

- 分时技术：把处理机的运行时间分成很短的时间片，按时间片轮流把处理机分配给各联机作业使用。

1970年代，个人计算机：每人用户对应一个系统，廉价，方便，易用。

## 3.2 服务器操作系统

### 3.2.1 Unix

**兼容分时系统 Multics**

为了进一步强化大型主机的功能，让主机的资源可以提供更多的使用者来利用，所以在1964年， 由贝 尔实验室(Bell)、麻省理工学院(MIT)及奇异公司(GE美国通用电气公司)共同发起了Multics（多路信息计 算系统）的计划， Multics计划的目的是让大型主机可以同时支持300个以上的终端机连线使用。不过， 到了1969年前后，由于计划进度缓慢，资金也短缺，所以该计划虽然继续在研究，但最终贝尔实验室还 是选择了退出。

**Unix的诞生**

1966年从加州大学伯克利分校毕业的Ken Thompson加入了贝尔实验室。参与了Multics系统的研发。 他基于Multics开发了“star travel”游戏。不幸的是，1969年由于贝尔实验室退出Multics项目，这同时意味着Ken将没有机器可以再玩这个游戏了。面对此情此景，Ken作为一个创造者的本性立即体现了出来，于是他决定自己写一个操作系统来满足他玩游戏的需要，Ken找到了一台废弃已久的老式计算机 PDP-7，并在这台只有16K内存的机器上重写了他的游戏。在这个过程中，Ken有了一个主意，要开发 一个全新的操作系统。利用PDP-7上的汇编语言，Ken只花了一个月就编写完了操作系统的内核，在这不到一个月的时间中，他一周一个内核，一个文件系统，一个编辑器和一个编译程序的完成。

**Unix 历史**

1、1965前后 Multics

贝尔实验室，麻省理工，通用电气发起

2、1969 Unix 雏形 UNICS

Ken Thompson 汇编语言B语言

3、1973正式命名为 Unix 

Dennis Ritchie C语言

4、1977 BSD

Berkeley Software Distribution 伯克利大学

5、1979 System V架构 版权声明

HP-UNIX IBM AIX“不对学生提供源码”收回版权

6、1984年 Minix 操作系统

Andrew S.Tanenbaum 荷兰阿姆斯特丹自由大学计算机科学系

**GNU**

1、GNU(GNU is Not Unix)

2、1984年由 Richard Stallman 发起并创建

3、目标是编写大量兼容于 Unix 系统的自由软件

4、官方网站:http://www.gnu.org

5、GPL(GNU General Public License)

6、自由软件基金会:Free Software Foundation

7、允许用户任意复制、传递、修改及再发布

8、基于自由软件修改再次发布的软件，仍需遵守 GPL 

9、LGPL(Lesser General Public License)

10、LGPL 相对于 GPL 较为宽松，允许不公开全部源代码

11、GNU操作系统: Hurd Hird of Unix-Replacing Daemons

### 3.2.2 Linux

![image-20240702155720093](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/image-20240702155720093.png)

1991年的10月5日Linus Benedict Torvalds在comp.os.minix 新闻组上发布消息，正式向外宣布他自行编写的完全自由免费的内核诞生（Freeminix-like kernel sources for 386-AT） FREAX，含义是怪诞的、怪物、异想天开类Unix的内核，在GPL下发布。

完整的类UNIX操作系统，Linux内核 + GNU工具 = Linux/GNU。Linux内核官网：[The Linux Kernel Archives](https://www.kernel.org/)

**Linux 设计哲学**：

1、一切都是一个文件（包括硬件）：在 Linux 里一切表示的都是单一的文件而不是像 windows 的图形界面。

2、小型，单一用途的程序：在 Linux 里有很多小工具，它们的功能都比较单一。

3、链接程序，共同完成复杂的任务：在 Linux 中遇到复杂的程序，一个小程序解决不了，则需要把一个一个的小程序关联起来。

4、避免令人困惑的用户界面。

5、配置数据存储在文本中。

## 3.3 Linux 发行版

![一张图看懂 主流Linux发行版 家族- Community - Deepin Technology](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/202101112228102239_Linux%E5%8F%91%E8%A1%8C%E7%89%884.png)

### 3.3.1 按照打包方式划分

**Debian系：**Debian GNU / Linux是一种强调使用自由软件的发行版，支持多种硬件平台。Debian及其派生发行版使用deb软件包格式，并使用dpkg及其前端作为软件包管理器。

- **Debian GNU/Linux**：由大批社区志愿者收集的包，拥有庞大的软件包可供选择（29000个以上），支持大量的硬件平台（12个计算机系统结构）。Debian强调开源和自由。
- **Deepin**：曾基于Debian（deepin V23 Preview后，放弃了debian上游，也把软件包格式更换为自研的"玲珑"），使用自行开发的Deepin DE桌面环境的发行版，启动迅速，UI简洁，开发了深度文件管理器，深度音乐，深度截图，深度终端等特色软件，还与软件厂商合作开发了有道词典、网易云音乐等Linux原生应用。以下基于Deepin：统一操作系统（UOS）：Deepin与中国电子、中兴、南京诚迈共同打造的商业化发行版。
- **Ubuntu**：知名Linux发行版之一，由Canonical有限公司赞助，基于Debian，使用自己的软件包库，与Debian的有所不同，旨在开发出更加友好的桌面。
- **kali linux** ：由 Offensive Security 开发的，主要针对寻找网络漏洞的道德黑客和渗透测试人员。它预装了大量的黑客工具和应用程序。适合程序员等的专业人士使用。

**Red Hat系：**Red Hat Linux和SUSE Linux是最早使用RPM格式软件包的发行版，如今RPM格式已广泛运用于众多的发行版。这两种发行版后来都分为商业版本和社区支持版本。Red Hat Linux的社区支持但受红帽公司赞助的版本现称为Fedora，商业版本则称为Red Hat Enterprise Linux。SUSE Linux则分成了SUSE Linux Enterprise和openSUSE。

- **CentOS**：由社群支持的包，旨在100%地与Red Hat Linux企业版兼容，但不包含Red Hat的商业软件。
- **Fedora**：可用作工作站、桌面以及服务器，由红帽公司及其社群开发。
- **Red Hat Enterprise Linux**：红帽Linux家族中唯一的商业分支。
- **Rocky Linux**：旨在成为一个使用红帽企业Linux（RHEL）操作系统源代码的完整的下游二进制兼容版本。该项目旨在提供一个由社区支持且可用于生产的企业操作系统。
- **SUSE／openSUSE**：来自德国，是欧洲最流行的包之一。跟红帽一样，也包括大量的软件，需要7张以上的CD，现在则用双DVD。这个包有独特的配置工具YaST。也是United Linux的创立者之一，已经被Novell公司收购。openSUSE是一个新的版本，基于社区，完全开源。

**Slackware系：**Slackware走了一条同其他的发行版本（Red Hat、Debian、Gentoo、SuSE、 Mandriva、Ubuntu等）不同的道路，它力图成为“UNIX风格”的Linux发行版本。它的方针是只吸收稳定版本的应用程序，并且缺少其他Linux版本中那些为发行版本定制的配置工具。

- **Slackware**：一个老牌包，由Patrick Volkerding维护，特别注重简洁与安全。

**Arch系：**起于Arch Linux，通常不采跨版本升级而是通过滚动更新来提供大多数软件的最新稳定版本。使用pacman作为包管理器，具有依赖处理和构建软件包的功能。除此之外，用户仓库 AUR 由世界各地的 Arch Linux 用户驱动，提供了海量的非官方软件以供选择。

- **Arch Linux**：基于KISS原则，针对x86-64的CPU做了优化，以.pkg.tar.zst格式打包并由包管理器进行跟踪维护，特别适合动手能力强的Linux用户。
- **SteamOS 3.0**：基于Arch Linux所开发，是美国Valve公司旗下混合型游戏主机Steam Deck 默认使用的操作系统，专为执行电子游戏而设计。目前官方发布版只能在Steam Deck上安装使用。


### 3.3.2 发行版汇总

![](./02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F/9650a70fd24e4f348299db5e2548cd57.png)

