# 一、算术运算的概念

​	算数式有运算符和操作数组组成，如 3+6。其中运算符为 + 号，操作数有 3、6，而得到的映射新量为 9。

​	在运算中，如果数字是以 0 开头的则被认为是 8 进制数，如果是 0x、0X 开头则是 16 进制数字。另外一种特殊数值表示方法：基数#数字，其中基数范围为：2-64，数字则值超过九就是用字母表示，如 a=10、b=11 以此类推。

​	例如：15 进制数：15#1a，值为 1x15+10; 2 进制数：2#1010，值为 1x2^3+1x2^1

​	在算数运算中有优先级之分，bash 中的优先级如下

| 优先级 | 运算符说明                            |
| ------ | ------------------------------------- |
| 1      | i++ 运算后加 1 、i-- 运算后减 1       |
| 2      | ++i 运算前加 1、--i 运算前减 1        |
| 3      | - 负号、+ 正号                        |
| 4      | ！逻辑非、~ 位的反置                  |
| 5      | ** 乘方                               |
| 6      | * 乘、/ 除、% 取余                    |
| 7      | + 加、- 减                            |
| 8      | << 向左移位、>> 向右移位              |
| 9      | <= 小于等于、 >= 大于等于、 <> 不等于 |
| 14     | && 逻辑与                             |
| 15     | \|\| 逻辑或                           |

# 二、加减乘除

下表列出了常用的算术运算符，假定变量 a 为 10，变量 b 为 20：

| 运算符 | 说明                                          | 举例                          |
| :----- | :-------------------------------------------- | :---------------------------- |
| +      | 加法                                          | `expr $a + $b` 结果为 30。    |
| -      | 减法                                          | `expr $a - $b` 结果为 -10。   |
| *      | 乘法                                          | `expr $a \* $b` 结果为  200。 |
| /      | 除法                                          | `expr $b / $a` 结果为 2。     |
| %      | 取余                                          | `expr $b % $a` 结果为 0。     |
| =      | 赋值                                          | a=$b 把变量 b 的值赋给 a。    |
| ==     | 相等。用于比较两个数字，相同则返回 true。     | [ $a == $b ] 返回 false。     |
| !=     | 不相等。用于比较两个数字，不相同则返回 true。 | [ $a != $b ] 返回 true。      |

## 2.1 加法

​	如下是一个简单的加法例子

```bash
[root@192 ~]# echo $((3+6))
9
```

​	在一个有变量的算数运算式中，在引用变量的值时需要先定义，然后变量才可以被引用，若变量没有被赋值，则在引用时将其视为 0

```bash
#!/bin/bash

declare -i x
declare -i y=4
echo $((x+y))

exit 0
```

​	运算结果

```bash
[root@192 ~]# bash test.sh 
4
```

​	在进行算数运算时，有时也使用算数拓展，算数拓展提供了一种强大的工具。算数拓展使用反引号 (``) 进行，通常与 expr 命令结合使用。这里的两个操作数需要与 + 保留空格。

```bash
[root@192 ~]# var=`expr 2 + 2`
[root@192 ~]# echo $var
4
```

## 2.2 减法

​	数值相减与加法运算相反，语法结构非常相似。

```bash
[root@192 ~]# echo $((3-1))
2
```

​	如果不提前赋予变量值，则得到的结果为常量

```bash
[root@192 ~]# echo $((8-i))
8
[root@192 ~]# echo $((j-5))
-5
[root@192 ~]# i=7
[root@192 ~]# echo $((i-3))
4
```

## 2.3 乘除

​	乘除与加减类似，只需要将运算符修改，并注意除数与被除数的一些数学问题即可。
```bash
[root@192 ~]# echo $((3*3))
9
[root@192 ~]# i=4
[root@192 ~]# echo $((3*i))
12
[root@192 ~]# echo $((12/i))
3
```

​	如果变量不提前赋予，则会被视为 0 值

```bash
[root@192 ~]# echo $((3*j))
0
[root@192 ~]# echo $((12/j))
-bash: 12/j: division by 0 (error token is "j")
```

​	为了避免除数为 0 导致运算出错，这里可以使用默认变量方式赋值

```bash
[root@192 ~]# i=4
[root@192 ~]# echo $((8/${i:-2}))
2
[root@192 ~]# unset i
[root@192 ~]# echo $((8/${i:-2}))
4
```

​	这里若变量 i 存在，则 8 / i 运算；若 i 没有赋值，则默认 i=2 ，用来进行运算。

# 三、数值大小比较

关系运算符只支持数字，不支持字符串，除非字符串的值是数字。

| 运算符 | 全拼          | 说明                                                  | 举例                       |
| :----- | ------------- | :---------------------------------------------------- | :------------------------- |
| -eq    | equal         | 检测两个数是否相等，相等返回 true。                   | [ $a -eq $b ] 返回 false。 |
| -ne    | not equal     | 检测两个数是否不相等，不相等返回 true。               | [ $a -ne $b ] 返回 true。  |
| -gt    | greater than  | 检测左边的数是否大于右边的，如果是，则返回 true。     | [ $a -gt $b ] 返回 false。 |
| -lt    | less than     | 检测左边的数是否小于右边的，如果是，则返回 true。     | [ $a -lt $b ] 返回 true。  |
| -ge    | greater equal | 检测左边的数是否大于等于右边的，如果是，则返回 true。 | [ $a -ge $b ] 返回 false。 |
| -le    | less equal    | 检测左边的数是否小于等于右边的，如果是，则返回 true。 | [ $a -le $b ] 返回 true。  |

​	示例

```bash
#!/bin/bash

a=10
b=20

if [ $a != $b ]
then
   echo "$a != $b : a 不等于 b"
else
   echo "$a == $b: a 等于 b"
fi
if [ $a -lt 100 -a $b -gt 15 ]
then
   echo "$a 小于 100 且 $b 大于 15 : 返回 true"
else
   echo "$a 小于 100 且 $b 大于 15 : 返回 false"
fi
if [ $a -lt 100 -o $b -gt 100 ]
then
   echo "$a 小于 100 或 $b 大于 100 : 返回 true"
else
   echo "$a 小于 100 或 $b 大于 100 : 返回 false"
fi
if [ $a -lt 5 -o $b -gt 100 ]
then
   echo "$a 小于 5 或 $b 大于 100 : 返回 true"
else
   echo "$a 小于 5 或 $b 大于 100 : 返回 false"
fi
```

​	运算结果

```bash
[root@192 ~]# bash test.sh 
10 != 20 : a 不等于 b
10 小于 100 且 20 大于 15 : 返回 true
10 小于 100 或 20 大于 100 : 返回 true
10 小于 5 或 20 大于 100 : 返回 false
```



# 四、逻辑运算

## 布尔运算符

下表列出了常用的布尔运算符，假定变量 a 为 10，变量 b 为 20：

| 运算符 | 说明                                                | 举例                                     |
| :----- | :-------------------------------------------------- | :--------------------------------------- |
| !      | 非运算，表达式为 true 则返回 false，否则返回 true。 | [ ! false ] 返回 true。                  |
| -o     | 或运算，有一个表达式为 true 则返回 true。           | [ $a -lt 20 -o $b -gt 100 ] 返回 true。  |
| -a     | 与运算，两个表达式都为 true 才返回 true。           | [ $a -lt 20 -a $b -gt 100 ] 返回 false。 |

## 逻辑运算符

以下介绍 Shell 的逻辑运算符，假定变量 a 为 10，变量 b 为 20:

| 运算符 | 说明       | 举例                                       |
| :----- | :--------- | :----------------------------------------- |
| &&     | 逻辑的 AND | [[ $a -lt 100 && $b -gt 100 ]] 返回 false  |
| \|\|   | 逻辑的 OR  | [[ $a -lt 100 \|\| $b -gt 100 ]] 返回 true |

​	示例

```bash
#!/bin/bash

a=10
b=20

if [[ $a -lt 100 && $b -gt 100 ]]
then
   echo "返回 true"
else
   echo "返回 false"
fi

if [[ $a -lt 100 || $b -gt 100 ]]
then
   echo "返回 true"
else
   echo "返回 false"
fi
```

​	运行结果

```bash
[root@192 ~]# bash test.sh 
返回 false
返回 true
```

